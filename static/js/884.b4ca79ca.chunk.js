"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[884],{884:(e,s,t)=>{t.r(s),t.d(s,{default:()=>H});var r=t(43),o=t(142);const a="ProfileInfo_descriptionBlock__h5PA2",i="ProfileInfo_coverImg__as+7Q",l="ProfileInfo_profileStatus__x-woA",n="ProfileInfo_userDescription__zhKqd",c="ProfileInfo_bio__KValO",d="ProfileInfo_expanded__p6LeK",u="ProfileInfo_toggleArrow__wIooa",p="ProfileInfo_contact__5kcik",h="ProfileInfo_editButton__yAgNm",m="ProfileInfo_skills__+1zdX";var f=t(50),x=t(314),j=t(579);const v=e=>{let{status:s,updateStatus:t}=e;const[o,a]=(0,r.useState)(!1),[i,l]=(0,r.useState)(s);(0,r.useEffect)((()=>{l(s)}),[s]);return(0,j.jsx)("b",{children:o?(0,j.jsx)("div",{children:(0,j.jsx)("input",{onChange:e=>{l(e.currentTarget.value)},onBlur:()=>{a(!1),t(i)},autoFocus:!0,value:i,placeholder:"Enter your status"})}):(0,j.jsx)("div",{children:(0,j.jsx)("span",{onDoubleClick:()=>{a(!0)},children:s||"------"})})})},g="ProfileDataForm_bio__K63t3",_="ProfileDataForm_formGroup__rOOgA",P="ProfileDataForm_skills__98HWe",b="ProfileDataForm_saveButton__yeVjy",N="ProfileDataForm_userName__TcCx1",k="ProfileDataForm_contact__oV5gU",y="ProfileDataForm_header__iyenu",I="ProfileDataForm_error__0AYfa",S="ProfileDataForm_userContacts__PBlbS";var A=t(64),F=t(858);const M=e=>{let{profile:s,onSubmit:t,setEditMode:o,errorMessage:a}=e;const[i,l]=(0,r.useState)(!0),[n,c]=(0,r.useState)(null),{register:d,handleSubmit:u,formState:{errors:p,touchedFields:h}}=(0,F.mN)({defaultValues:{fullName:s.fullName,lookingForAJob:s.lookingForAJob,lookingForAJobDescription:s.lookingForAJobDescription,aboutMe:s.aboutMe,contacts:s.contacts||{}}});return(0,j.jsx)("form",{onSubmit:u((e=>t(e,c))),children:(0,j.jsxs)("div",{className:g,children:[(0,j.jsxs)("div",{className:y,onClick:()=>{l(!i),i&&o(!1)},children:["Main user info",(0,j.jsx)("span",{children:"\u25b2"})]}),i&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{className:_,children:[(0,j.jsx)("b",{className:N,children:"Name: "}),(0,j.jsx)(A.MJ,{Component:"input",name:"fullName",register:d,errors:p,touchedFields:h})]}),(0,j.jsxs)("div",{className:_,children:[(0,j.jsx)("b",{children:"Looking for a job: "}),(0,j.jsx)("input",{type:"checkbox",...d("lookingForAJob")})]}),(0,j.jsxs)("div",{className:_,children:[(0,j.jsx)("b",{children:"My professional skills: "}),(0,j.jsx)("div",{className:P,children:(0,j.jsx)(A.MJ,{Component:"textarea",name:"lookingForAJobDescription",register:d,errors:p,touchedFields:h})})]}),(0,j.jsxs)("div",{className:_,children:[(0,j.jsx)("b",{children:"About me: "}),(0,j.jsx)(A.MJ,{Component:"textarea",name:"aboutMe",register:d,errors:p,touchedFields:h})]}),(0,j.jsx)("div",{className:_,children:(0,j.jsxs)("div",{className:S,children:[(0,j.jsx)("b",{children:"Contacts: "}),Object.keys(s.contacts).map((e=>(0,j.jsxs)("div",{className:k,children:[(0,j.jsxs)("b",{children:[e,":"]}),(0,j.jsx)(A.MJ,{Component:"input",name:`contacts.${e}`,register:d,errors:p,touchedFields:h}),"string"===typeof a?e.includes(a.split(/[-()>]/)[3].toLowerCase())&&(0,j.jsx)("span",{className:I,children:a}):""]},e)))]})}),(0,j.jsx)("div",{children:(0,j.jsx)("button",{type:"submit",className:b,children:"Save info"})})]})]})})},C=e=>{let{contactTitle:s,contactValue:t}=e;return(0,j.jsxs)("div",{className:p,children:[(0,j.jsxs)("b",{children:[s,":"]})," ",(0,j.jsx)("span",{children:t})]})},w=e=>{let{profile:s,isOwner:t,activateEditMode:r,expanded:o,setExpanded:a}=e;return(0,j.jsx)("div",{children:(0,j.jsxs)("div",{className:`${c} ${o?d:""}`,onClick:()=>a(!o),children:["Main user info",(0,j.jsx)("span",{className:u,children:o?"\u25b2":"\u25bc"}),(0,j.jsxs)("div",{children:[(0,j.jsx)("b",{children:"Name: "})," ",s.fullName]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("b",{children:"Looking for a job: "})," ",s.lookingForAJob?"yes":"no"]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("b",{children:"My professional skills: "})," ",(0,j.jsxs)("div",{className:m,children:[s.lookingForAJobDescription||"not filled"," "]})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("b",{children:"About me: "})," ",s.aboutMe]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("b",{children:"Contacts: "})," ",Object.keys(s.contacts).map((e=>(0,j.jsx)(C,{contactTitle:e,contactValue:s.contacts[e]},e)))]}),t&&(0,j.jsx)("div",{children:(0,j.jsx)("button",{onClick:r,className:h,children:"Edit info"})})]})})},D=e=>{let{profile:s,status:t,updateStatus:c,isOwner:d,savePhoto:u,saveProfile:p}=e;const[h,m]=(0,r.useState)(!1),[g,_]=(0,r.useState)(!1),[P,b]=(0,r.useState)(null);if(!s)return(0,j.jsx)(f.A,{});return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{children:(0,j.jsx)("img",{className:i,src:o.Bh,alt:"logo"})}),(0,j.jsxs)("div",{className:a,children:[s&&s.photos?(0,j.jsxs)("div",{className:n,children:[(0,j.jsx)("img",{src:s.photos.large||x,alt:""}),d?(0,j.jsx)("input",{type:"file",onChange:e=>{if(e.target.files.length){const s=e.target.files[0];u(s)}}}):"",h?(0,j.jsx)(M,{profile:s,onSubmit:async(e,t)=>{try{const r={...s,...e,userId:s.userId,photos:s.photos},o=await p(r);o&&o.error?((e,s,t)=>{if(e.errors&&s)e.errors.forEach((e=>{let{field:t,message:r}=e;s(t,{type:"server",message:r})}));else if(e.message&&s){const r=e.message.match(/Invalid url format \(Contacts -> (\w+)\)/);if(r){const e=r[1].toLowerCase();s(`contacts.${e}`,{type:"server",message:"Invalid URL format"})}else null===t||void 0===t||t(e.message)}else"string"===typeof e?null===t||void 0===t||t(e):null===t||void 0===t||t("An error occurred while saving profile")})(o.error,t,b):(m(!1),_(!0),b(null))}catch(r){if(r.errors&&t)r.errors.forEach((e=>{let{field:s,message:r}=e;t(s,{type:"server",message:r})}));else if(r.message&&t){const e=r.message.match(/Invalid url format \(Contacts -> (\w+)\)/);if(e){const s=e[1].toLowerCase();t(`contacts.${s}`,{type:"server",message:"Invalid URL format"})}else b(r.message)}}},setExpanded:_,setEditMode:m,errorMessage:P}):(0,j.jsx)(w,{activateEditMode:e=>{m(!0),e.stopPropagation()},profile:s,isOwner:d,expanded:g,setExpanded:_})]}):(0,j.jsx)(f.A,{}),(0,j.jsxs)("div",{className:l,children:["Status ",(0,j.jsx)(v,{status:t,updateStatus:c})]})]})]})};var J=t(970);const O="MyPosts_item__b+cMR",E="MyPosts_posts__MmXOc",L="Post_content__rPvB-",z="Post_item__gR0QO",U=e=>{let{image:s,message:t,likes:r}=e;return(0,j.jsx)("div",{className:z,children:(0,j.jsxs)("div",{className:L,children:[(0,j.jsx)("img",{src:s,alt:""}),(0,j.jsxs)("span",{children:[" ",t," "]}),(0,j.jsx)("div",{children:(0,j.jsxs)("span",{children:[" Like ",r," "]})})]})})},B=e=>(0,j.jsx)(A.c3,{onAddPost:e.onAddPost}),T=e=>{const s=[...e.posts].reverse().map(((e,s)=>(0,j.jsx)(U,{image:o.my,message:e.message,likes:e.likesCount},s)));return(0,j.jsxs)("div",{className:O,children:[(0,j.jsx)("h3",{children:"My posts"}),(0,j.jsx)(B,{onAddPost:s=>{e.updateNewPostText(s),e.addPost(s)}}),(0,j.jsx)("div",{className:E,children:s})]})},V=r.memo(T);var $=t(3);const K=(0,$.Ng)((e=>({posts:e.profilePage.posts,newPostText:e.profilePage.newPostText,users:e.usersPage.users})),(e=>({updateNewPostText:s=>{let t=(0,J.uJ)(s);e(t)},addPost:s=>{e((0,J.oL)(s))}})))(V),R=e=>{let{profile:s,isOwner:t,status:r,updateStatus:o,savePhoto:a,saveProfile:i}=e;return(0,j.jsxs)("div",{children:[(0,j.jsx)(D,{profile:s,isOwner:t,status:r,updateStatus:o,savePhoto:a,saveProfile:i}),(0,j.jsx)(K,{})]})};var Q=t(906),X=t(787),Z=t(923);class q extends r.Component{refreshProfile(){let e=this.props.params.userId||this.props.authorizedUserId;this.props.getUserProfile(e),this.props.getStatus(e)}componentDidMount(){this.refreshProfile()}componentDidUpdate(e,s,t){(this.props.params.userId||this.props.authorizedUserId)!==(e.params.userId||e.authorizedUserId)&&this.refreshProfile()}render(){return(0,j.jsx)(R,{...this.props,isOwner:!this.props.params.userId,profile:this.props.profile,status:this.props.status,updateStatus:this.props.updateStatus,savePhoto:this.props.savePhoto,saveProfile:this.props.saveProfile})}}const G=(0,$.Ng)((e=>({profile:e.profilePage.profile,status:e.profilePage.status,authorizedUserId:e.auth.userId,isAuthorized:e.auth.isAuthorized})),{getUserProfile:J.VM,getStatus:J.BS,updateStatus:J.yB,savePhoto:J.Ah,saveProfile:J.Lt}),H=(0,Z.Zz)(G,(function(e){return s=>{const t=(0,Q.Zp)(),r=(0,Q.g)(),o=(0,Q.zy)();return(0,j.jsx)(e,{...s,navigate:t,params:r,location:o})}}),X.A)(q)}}]);
//# sourceMappingURL=884.b4ca79ca.chunk.js.map